<div class="main-container bg-white dark:bg-black">
  <!-- Header -->
  <div class="header-section flex items-center p-4 pb-3 border-b border-gray-200 dark:[border-color:var(--color-border)]">
    <!-- Left side: Back button -->
    <button (click)="onBack()" class="w-8 h-8 flex items-center justify-center rounded-full hover:bg-gray-100 dark:hover:bg-gray-900 dark:[color:var(--color-text)]">
      <i class="fas fa-arrow-left text-lg"></i>
    </button>

    <!-- Center: Title (absolute center) -->
    <h2 class="flex-1 text-xl font-bold text-gray-900 dark:text-white text-center">Drafts</h2>

    <!-- Right side: Edit button (fixed width) -->
    <button (click)="toggleEditMode()" class="w-12 h-8 flex items-center justify-center text-sm font-medium rounded-full hover:bg-gray-100 dark:hover:bg-gray-900 dark:[color:var(--color-text)]">
      {{ isEditMode ? 'Done' : 'Edit' }}
    </button>
  </div>

  <!-- Custom Tabs -->
  <div class="tabs-section flex border-b border-gray-200 dark:[border-color:var(--color-border)]">
    <button 
      (click)="selectedTab = 'unsent'"
      [class]="selectedTab === 'unsent' ? 'border-blue-500 text-blue-600 dark:text-blue-400' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'"
      class="flex-1 px-4 py-3 border-b-2 font-medium text-sm transition-colors">
      Unsent Posts
    </button>
    <button 
      (click)="selectedTab = 'scheduled'"
      [class]="selectedTab === 'scheduled' ? 'border-blue-500 text-blue-600 dark:text-blue-400' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'"
      class="flex-1 px-4 py-3 border-b-2 font-medium text-sm transition-colors">
      Scheduled Posts
    </button>
  </div>

  <!-- Top Controls - Edit Mode -->
  <div class="px-3 py-2 border-b border-gray-200 dark:[border-color:var(--color-border)] bg-gray-50 dark:bg-gray-900" 
       [class.hidden]="!isEditMode">
    <div class="flex gap-3 items-start justify-between">
      <!-- Select All Section aligned with checkboxes -->
      <div class="flex gap-3 items-start">
        <!-- Checkbox aligned with individual checkboxes -->
        <div class="w-4 flex-shrink-0 mt-1">
          <input 
            type="checkbox" 
            [checked]="selectedTab === 'unsent' ? allDraftsSelected : allScheduledSelected"
            (click)="selectedTab === 'unsent' ? selectAllDrafts() : selectAllScheduled()"
            class="w-4 h-4 text-blue-600 rounded focus:ring-blue-500 dark:focus:ring-blue-600">
        </div>
        
        <!-- Select All Text aligned with content -->
        <div class="flex-1 text-gray-900 dark:text-white">
          <button 
            (click)="selectedTab === 'unsent' ? selectAllDrafts() : selectAllScheduled()"
            class="text-sm font-medium text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300">
            {{ (selectedTab === 'unsent' ? allDraftsSelected : allScheduledSelected) ? 'Deselect All' : 'Select All' }}
          </button>
        </div>
      </div>

      <!-- Delete Button -->
      <button 
        [disabled]="!hasSelectedItems"
        (click)="deleteSelectedItems()"
        class="text-sm font-medium transition-colors"
        [class.text-red-500]="hasSelectedItems"
        [class.hover:text-red-600]="hasSelectedItems"
        [class.text-red-300]="!hasSelectedItems"
        [class.cursor-not-allowed]="!hasSelectedItems">
        Delete
      </button>
    </div>
  </div>

  <!-- Tab Content - Scrollable Area -->
  <div class="content-area">
    <!-- Unsent Posts Tab -->
    <div *ngIf="selectedTab === 'unsent'">
      <div *ngIf="drafts.length === 0" class="text-center py-6 px-4 text-gray-500 dark:text-gray-400">
        <i class="fas fa-file-alt text-4xl mb-4 opacity-50"></i>
        <p class="text-lg">No drafts saved</p>
        <p class="text-sm">Your saved drafts will appear here</p>
      </div>

      <div *ngFor="let draft of drafts" class="px-3 py-2 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors cursor-pointer border-b border-gray-200 dark:border-gray-700" (click)="!isEditMode && onDraftEdit(draft)">
        <!-- Main Content Area -->
        <div class="flex gap-3 items-start">
          <!-- Checkbox (Edit Mode) - Always reserve space -->
          <div class="w-4 flex-shrink-0 mt-1">
            <input 
              *ngIf="isEditMode"
              type="checkbox" 
              [checked]="selectedDraftIds.has(draft.id)"
              (change)="toggleDraftSelection(draft.id)"
              (click)="$event.stopPropagation()"
              class="w-4 h-4 text-blue-600 rounded focus:ring-blue-500 dark:focus:ring-blue-600">
          </div>
          
          <!-- Draft Content -->
          <div class="flex-1 text-gray-900 dark:text-white">
            <!-- Scheduled Time -->
            <div *ngIf="draft.scheduledTime" class="flex items-center text-xs text-blue-600 dark:text-blue-400 mb-1">
              <i class="fas fa-clock mr-1"></i>
              Scheduled for {{ formatScheduledTime(draft.scheduledTime) }}
            </div>
          <p class="mb-1">{{ getPreviewText(draft.content) }}</p>
          
          <!-- Images Preview -->
          <div *ngIf="draft.images && draft.images.length > 0" class="flex gap-2 mb-1">
            <div *ngFor="let image of draft.images.slice(0, 3)" class="w-8 h-8 bg-gray-200 dark:bg-gray-700 rounded border">
              <img [src]="image.preview" class="w-full h-full object-cover rounded" alt="Draft image">
            </div>
            <div *ngIf="draft.images.length > 3" class="w-8 h-8 bg-gray-200 dark:bg-gray-700 rounded border flex items-center justify-center text-xs text-gray-600 dark:text-gray-300">
              +{{ draft.images.length - 3 }}
            </div>
          </div>

          <!-- Quote Post Preview -->
          <div *ngIf="draft.quotePost" class="border border-gray-300 dark:border-gray-600 rounded-lg p-3 bg-gray-50 dark:bg-gray-800 text-sm">
            <div class="flex items-center gap-2 mb-1">
              <span class="font-semibold">{{ draft.quotePost.author.username }}</span>
              <span class="text-gray-500 dark:text-gray-400">{{ draft.quotePost.author.handle }}</span>
            </div>
            <p class="text-gray-700 dark:text-gray-300">{{ getPreviewText(draft.quotePost.content) }}</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Scheduled Posts Tab -->
    <div *ngIf="isScheduledTab">
      <div *ngIf="scheduledPosts.length === 0" class="text-center py-8 px-4 text-gray-500 dark:text-gray-400">
        <i class="fas fa-calendar-alt text-4xl mb-4 opacity-50"></i>
        <p class="text-lg">No scheduled posts</p>
        <p class="text-sm">Your scheduled posts will appear here</p>
      </div>

      <div *ngFor="let scheduledPost of scheduledPosts" class="px-3 py-2 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors border-b border-gray-200 dark:border-gray-700" [class.cursor-pointer]="!isEditMode && scheduledPost.status === 'scheduled'" (click)="!isEditMode && scheduledPost.status === 'scheduled' && onScheduledPostEdit(scheduledPost)">
        <!-- Main Content Area -->
        <div class="flex gap-3 items-start">
          <!-- Checkbox (Edit Mode) - Always reserve space -->
          <div class="w-4 flex-shrink-0 mt-1">
            <input 
              *ngIf="isEditMode"
              type="checkbox" 
              [checked]="selectedScheduledIds.has(scheduledPost.id)"
              (change)="toggleScheduledSelection(scheduledPost.id)"
              (click)="$event.stopPropagation()"
              class="w-4 h-4 text-blue-600 rounded focus:ring-blue-500 dark:focus:ring-blue-600">
          </div>
          
          <!-- Scheduled Post Content -->
          <div class="flex-1 text-gray-900 dark:text-white">
            <!-- Status and Time -->
            <div class="flex items-center gap-2 mb-0.5">
              <span [class]="getStatusColor(scheduledPost.status)" class="px-2 py-1 rounded-full text-xs font-medium">
                {{ getStatusText(scheduledPost.status) }}
              </span>
            </div>
            <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">
              <i class="fas fa-clock mr-1"></i>
              {{ formatScheduledTime(scheduledPost.scheduledTime) }}
            </p>
          <p class="mb-1">{{ getPreviewText(scheduledPost.content) }}</p>
          
          <!-- Images Preview -->
          <div *ngIf="scheduledPost.images && scheduledPost.images.length > 0" class="flex gap-2 mb-1">
            <div *ngFor="let image of scheduledPost.images.slice(0, 3)" class="w-8 h-8 bg-gray-200 dark:bg-gray-700 rounded border">
              <img [src]="image.preview" class="w-full h-full object-cover rounded" alt="Scheduled post image">
            </div>
            <div *ngIf="scheduledPost.images.length > 3" class="w-8 h-8 bg-gray-200 dark:bg-gray-700 rounded border flex items-center justify-center text-xs text-gray-600 dark:text-gray-300">
              +{{ scheduledPost.images.length - 3 }}
            </div>
          </div>

          <!-- Quote Post Preview -->
          <div *ngIf="scheduledPost.quotePost" class="border border-gray-300 dark:border-gray-600 rounded-lg p-3 bg-gray-50 dark:bg-gray-800 text-sm">
            <div class="flex items-center gap-2 mb-1">
              <span class="font-semibold">{{ scheduledPost.quotePost.author.username }}</span>
              <span class="text-gray-500 dark:text-gray-400">{{ scheduledPost.quotePost.author.handle }}</span>
            </div>
            <p class="text-gray-700 dark:text-gray-300">{{ getPreviewText(scheduledPost.quotePost.content) }}</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div> 