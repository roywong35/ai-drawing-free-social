<div class="max-w-2xl mx-auto pt-4">
  <!-- Post Detail -->
  <div *ngIf="post" class="bg-white rounded-lg shadow">
    <app-post [post]="post" [isDetailView]="true"></app-post>
  </div>

  <!-- Comment Input -->
  <div *ngIf="post" class="mt-4 bg-white rounded-lg shadow">
    <div class="p-4">
      <div class="flex gap-3">
        <img [src]="currentUser?.profile_picture || defaultAvatar" 
             alt="Your avatar" 
             class="w-8 h-8 rounded-full bg-gray-100">
        <div class="flex-1">
          <!-- Compact View -->
          <div *ngIf="!isReplyFocused" 
               class="border rounded-lg hover:bg-gray-50 cursor-text"
               (click)="isReplyFocused = true">
            <div class="flex items-center justify-between p-2">
              <span class="text-gray-500 ml-2">Post your reply</span>
              <button class="px-4 py-1.5 bg-blue-500 text-white rounded-full hover:bg-blue-600 font-semibold mr-1">
                Reply
              </button>
            </div>
          </div>

          <!-- Expanded View -->
          <div *ngIf="isReplyFocused" class="w-full">
            <textarea
              [(ngModel)]="newCommentContent"
              (blur)="!newCommentContent && (isReplyFocused = false)"
              class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 min-h-[120px] resize-none"
              placeholder="Post your reply"
              #replyInput
              (focus)="isReplyFocused = true"
              autoFocus
            ></textarea>
            <div class="flex justify-end mt-2 gap-2">
              <button
                (click)="isReplyFocused = false; newCommentContent = ''"
                class="px-4 py-1.5 text-gray-600 hover:text-gray-800 font-semibold"
              >
                Cancel
              </button>
              <button
                (click)="submitComment()"
                [disabled]="!newCommentContent.trim()"
                class="px-6 py-1.5 bg-blue-500 text-white rounded-full hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed font-semibold"
              >
                Reply
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Comments List -->
  <div *ngIf="topLevelComments?.length" class="mt-4">
    <app-comment
      *ngFor="let comment of topLevelComments"
      [comment]="comment"
      [postId]="post?.id!"
      (commentUpdated)="onCommentUpdated()"
    ></app-comment>
  </div>

  <!-- No Comments Message -->
  <div *ngIf="post && (!topLevelComments || topLevelComments.length === 0)" class="mt-4 bg-white rounded-lg shadow">
    <div class="p-4 text-center text-gray-500">
      No replies yet. Be the first to reply!
    </div>
  </div>
</div> 